"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[3673],{83673:(e,t,a)=>{a.d(t,{Z:()=>w});var i=a(67294),l=a(74069),n=a(9875),r=a(35932),s=a(4715),c=a(15926),o=a.n(c),d=a(51995),h=a(61988),u=a(31069),m=a(44818),p=a(93185),b=a(55786),f=a(14114),g=a(60718),y=a(48273),_=a(35944);const Z=s.qz.Item,T=(0,d.iK)(s.qz.Item)`
  margin-bottom: 0;
`,v=d.iK.span`
  margin-bottom: 0;
`;var C={name:"1blj7km",styles:"margin-top:1em"};const w=(0,f.ZP)((function({slice:e,onHide:t,onSave:a,show:c,addSuccessToast:d}){const[f,w]=(0,i.useState)(!1),[S]=s.qz.useForm(),[k,X]=(0,i.useState)(e.slice_name||""),[B,x]=(0,i.useState)(null),[I,N]=(0,i.useState)([]),j=(0,i.useMemo)((()=>I.map((e=>({value:e.id,label:e.name})))),[I.length]);function q({error:e,statusText:t,message:a}){let i=e||t||(0,h.t)("An error has occurred");"Forbidden"===a&&(i=(0,h.t)("You do not have permission to edit this chart")),l.default.error({title:(0,h.t)("Error"),content:i,okButtonProps:{danger:!0,className:"btn-danger"}})}const $=(0,i.useCallback)((async function(){try{var t;const a=(await u.Z.get({endpoint:`/api/v1/chart/${e.slice_id}`})).json.result;x(null==a||null==(t=a.owners)?void 0:t.map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))))}catch(e){q(await(0,m.O$)(e))}}),[e.slice_id]),z=(0,i.useMemo)((()=>(e="",t,a)=>{const i=o().encode({filter:e,page:t,page_size:a});return u.Z.get({endpoint:`/api/v1/chart/related/owners?q=${i}`}).then((e=>({data:e.json.result.filter((e=>e.extra.active)).map((e=>({value:e.value,label:e.text}))),totalCount:e.json.count})))}),[]),A=(0,h.t)("Owners");return(0,i.useEffect)((()=>{$()}),[$]),(0,i.useEffect)((()=>{X(e.slice_name||"")}),[e.slice_name]),(0,i.useEffect)((()=>{if((0,p.cr)(p.TT.TaggingSystem))try{(0,y.$3)({objectType:y.g.CHART,objectId:e.slice_id,includeTypes:!1},(e=>N(e)),(e=>{q(e)}))}catch(e){q(e)}}),[e.slice_id]),(0,_.tZ)(l.default,{show:c,onHide:t,title:(0,h.t)("Edit Chart Properties"),footer:(0,_.BX)(_.HY,{children:[(0,_.tZ)(r.Z,{htmlType:"button",buttonSize:"small",onClick:t,cta:!0,children:(0,h.t)("Cancel")}),(0,_.tZ)(r.Z,{htmlType:"submit",buttonSize:"small",buttonStyle:"primary",onClick:S.submit,disabled:f||!k||e.is_managed_externally,tooltip:e.is_managed_externally?(0,h.t)("This chart is managed externally, and can't be edited in Superset"):"",cta:!0,children:(0,h.t)("Save")})]}),responsive:!0,wrapProps:{},children:(0,_.tZ)(s.qz,{form:S,onFinish:async i=>{w(!0);const{certified_by:l,certification_details:n,description:r,cache_timeout:s}=i,c={slice_name:k||null,description:r||null,cache_timeout:s||null,certified_by:l||null,certification_details:l&&n?n:null};B&&(c.owners=B.map((e=>e.value))),(0,p.cr)(p.TT.TaggingSystem)&&(c.tags=I.map((e=>e.id)));try{const i=await u.Z.put({endpoint:`/api/v1/chart/${e.slice_id}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),l={...c,...i.json.result,tags:I,id:e.slice_id,owners:B};a(l),d((0,h.t)("Chart properties updated")),t()}catch(e){q(await(0,m.O$)(e))}w(!1)},layout:"vertical",initialValues:{name:e.slice_name||"",description:e.description||"",cache_timeout:null!=e.cache_timeout?e.cache_timeout:"",certified_by:e.certified_by||"",certification_details:e.certified_by&&e.certification_details?e.certification_details:""},children:(0,_.BX)(s.X2,{gutter:16,children:[(0,_.BX)(s.JX,{xs:24,md:12,children:[(0,_.tZ)("h3",{children:(0,h.t)("Basic information")}),(0,_.tZ)(Z,{label:(0,h.t)("Name"),required:!0,children:(0,_.tZ)(n.II,{"aria-label":(0,h.t)("Name"),name:"name",type:"text",value:k,onChange:e=>{var t;return X(null!=(t=e.target.value)?t:"")}})}),(0,_.BX)(Z,{children:[(0,_.tZ)(T,{label:(0,h.t)("Description"),name:"description",children:(0,_.tZ)(n.Kx,{rows:3,style:{maxWidth:"100%"}})}),(0,_.tZ)(v,{className:"help-block",children:(0,h.t)("The description can be displayed as widget headers in the dashboard view. Supports markdown.")})]}),(0,_.tZ)("h3",{children:(0,h.t)("Certification")}),(0,_.BX)(Z,{children:[(0,_.tZ)(T,{label:(0,h.t)("Certified by"),name:"certified_by",children:(0,_.tZ)(n.II,{"aria-label":(0,h.t)("Certified by")})}),(0,_.tZ)(v,{className:"help-block",children:(0,h.t)("Person or group that has certified this chart.")})]}),(0,_.BX)(Z,{children:[(0,_.tZ)(T,{label:(0,h.t)("Certification details"),name:"certification_details",children:(0,_.tZ)(n.II,{"aria-label":(0,h.t)("Certification details")})}),(0,_.tZ)(v,{className:"help-block",children:(0,h.t)("Any additional detail to show in the certification tooltip.")})]})]}),(0,_.BX)(s.JX,{xs:24,md:12,children:[(0,_.tZ)("h3",{children:(0,h.t)("Configuration")}),(0,_.BX)(Z,{children:[(0,_.tZ)(T,{label:(0,h.t)("Cache timeout"),name:"cache_timeout",children:(0,_.tZ)(n.II,{"aria-label":"Cache timeout"})}),(0,_.tZ)(v,{className:"help-block",children:(0,h.t)("Duration (in seconds) of the caching timeout for this chart. Set to -1 to bypass the cache. Note this defaults to the dataset's timeout if undefined.")})]}),(0,_.tZ)("h3",{style:{marginTop:"1em"},children:(0,h.t)("Access")}),(0,_.BX)(Z,{label:A,children:[(0,_.tZ)(s.qb,{ariaLabel:A,mode:"multiple",name:"owners",value:B||[],onChange:x,options:z,disabled:!B,allowClear:!0}),(0,_.tZ)(v,{className:"help-block",children:(0,h.t)("A list of users who can alter the chart. Searchable by name or username.")})]}),(0,p.cr)(p.TT.TaggingSystem)&&(0,_.tZ)("h3",{css:C,children:(0,h.t)("Tags")}),(0,p.cr)(p.TT.TaggingSystem)&&(0,_.BX)(Z,{children:[(0,_.tZ)(s.qb,{ariaLabel:"Tags",mode:"multiple",value:j,options:g.m,onChange:e=>{const t=(0,b.Z)(e).map((e=>({id:e.value,name:e.label})));N(t)},onClear:()=>{N([])},allowClear:!0}),(0,_.tZ)(v,{className:"help-block",children:(0,h.t)("A list of tags that have been applied to this chart.")})]})]})]})})})}))}}]);
//# sourceMappingURL=3b1cb99c7903e8c1b745.chunk.js.map