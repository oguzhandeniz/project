"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9563],{54070:(e,t,a)=>{a.d(t,{w:()=>i});var l=a(58593),n=a(83379),r=a(61988),o=a(35944);const i=({user:e,date:t})=>{const a=(0,o.tZ)("span",{className:"no-wrap",children:t});if(e){const t=(0,n.Z)(e),i=(0,r.t)("Modified by: %s",t);return(0,o.tZ)(l.u,{title:i,placement:"bottom",children:a})}return a}},19259:(e,t,a)=>{a.d(t,{Z:()=>o});var l=a(67294),n=a(17198),r=a(35944);function o({title:e,description:t,onConfirm:a,children:o}){const[i,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)([]),u=()=>{s(!1),d([])};return(0,r.BX)(r.HY,{children:[null==o?void 0:o(((...e)=>{e.forEach((e=>{e&&("function"==typeof e.persist&&e.persist(),"function"==typeof e.preventDefault&&e.preventDefault(),"function"==typeof e.stopPropagation&&e.stopPropagation())})),s(!0),d(e)})),(0,r.tZ)(n.Z,{description:t,onConfirm:()=>{a(...c),u()},onHide:u,open:i,title:e})]})}},34581:(e,t,a)=>{a.d(t,{Z:()=>m});var l=a(81545),n=a(51995),r=a(58593),o=a(4715);var i,s,c=a(35944);const d=null!=(i=null==(s=(0,l.Z)().get())?void 0:s.colors)?i:[],u=e=>{const t=8*e.gridUnit;return`\n  width: ${t}px;\n  height: ${t}px;\n  line-height: ${t}px;\n  font-size: ${e.typography.sizes.s}px;`},p=(0,n.iK)(o.qE)`
  ${({theme:e})=>u(e)}
`,h=(0,n.iK)(o.qE.Group)`
  .ant-avatar {
    ${({theme:e})=>u(e)}
  }
`;function m({users:e,maxCount:t=4}){return(0,c.tZ)(h,{maxCount:t,children:e.map((({first_name:e,last_name:t,id:a})=>{var l,n;const o=`${e} ${t}`,i=function(e,t){return e?t[function(e,t){const a=[...e].map((e=>e.charCodeAt(0))),l=a.length,n=l%(t-1)+1,r=a.reduce(((e,t)=>e+t))%t;let o=a[0]%t;return[...new Array(l)].forEach((()=>{o=(n*o+r)%t})),o}(e,t.length)]:"transparent"}(`${a}-${e}-${t}`,d),s=`/api/v1/user/${a}/avatar.png`;return(0,c.tZ)(r.u,{title:o,placement:"top",children:(0,c.BX)(p,{style:{backgroundColor:i,borderColor:i},src:s,children:[null==e||null==(l=e[0])?void 0:l.toLocaleUpperCase(),null==t||null==(n=t[0])?void 0:n.toLocaleUpperCase()]},o)},o)}))})}},29848:(e,t,a)=>{a.d(t,{Z:()=>c});var l=a(51995),n=a(58593),r=a(13322),o=a(35944);const i=l.iK.span`
  white-space: nowrap;
  min-width: 100px;
  svg,
  i {
    margin-right: 8px;

    &:hover {
      path {
        fill: ${({theme:e})=>e.colors.primary.base};
      }
    }
  }
`,s=l.iK.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
`;function c({actions:e}){return(0,o.tZ)(i,{className:"actions",children:e.map(((e,t)=>{const a=r.Z[e.icon];return e.tooltip?(0,o.tZ)(n.u,{id:`${e.label}-tooltip`,title:e.tooltip,placement:e.placement,children:(0,o.tZ)(s,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick,children:(0,o.tZ)(a,{})})},t):(0,o.tZ)(s,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick,children:(0,o.tZ)(a,{})},t)}))})}},32635:(e,t,a)=>{a.r(t),a.d(t,{default:()=>W});var l=a(67294),n=a(16550),r=a(75049),o=a(61988),i=a(22102),s=a(51995),c=a(31069),d=a(30381),u=a.n(d),p=a(29848),h=a(34581),m=a(58593),g=a(93139),b=a(86074),Z=a(12441),f=a(27600),v=a(14114),y=a(94222),w=a(11965),k=a(13322),C=a(90335),$=a(35944);const S=e=>w.iv`
  color: ${e.colors.grayscale.light1};
  margin-right: ${2*e.gridUnit}px;
`;function x({type:e}){const t={icon:null,label:""};switch(e){case C.cv.Email:t.icon=(0,$.tZ)(k.Z.Email,{css:S}),t.label=C.cv.Email;break;case C.cv.Slack:case C.cv.SlackV2:t.icon=(0,$.tZ)(k.Z.Slack,{css:S}),t.label=C.cv.Slack;break;default:t.icon=null,t.label=""}return t.icon?(0,$.tZ)(m.u,{title:t.label,placement:"bottom",children:t.icon}):null}var E=a(19259),_=a(17198);u().updateLocale("en",{calendar:{lastDay:"[Yesterday at] LTS",sameDay:"[Today at] LTS",nextDay:"[Tomorrow at] LTS",lastWeek:"[last] dddd [at] LTS",nextWeek:"dddd [at] LTS",sameElse:"L"}});const T=s.iK.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
`,A=(0,s.iK)(k.Z.Refresh)`
  color: ${({theme:e})=>e.colors.primary.base};
  width: auto;
  height: ${({theme:e})=>5*e.gridUnit}px;
  position: relative;
  top: ${({theme:e})=>e.gridUnit}px;
  left: ${({theme:e})=>e.gridUnit}px;
  cursor: pointer;
`,H=({updatedAt:e,update:t})=>{const[a,n]=(0,l.useState)(u()(e));return(0,l.useEffect)((()=>{n((()=>u()(e)));const t=setInterval((()=>{n((()=>u()(e)))}),6e4);return()=>clearInterval(t)}),[e]),(0,$.BX)(T,{children:[(0,o.t)("Last Updated %s",a.isValid()?a.calendar():"--"),t&&(0,$.tZ)(A,{onClick:t})]})};var L=a(34858),z=a(40768),D=a(22318),B=a(67317),N=a(54070),R=a(12);const U=(0,r.I)(),K={[C.Z9.Success]:(0,o.t)("Success"),[C.Z9.Working]:(0,o.t)("Working"),[C.Z9.Error]:(0,o.t)("Error"),[C.Z9.Noop]:(0,o.t)("Not triggered"),[C.Z9.Grace]:(0,o.t)("On Grace")},M=(0,i.Z)({requestType:"rison",method:"DELETE",endpoint:"/api/v1/report/"}),I=s.iK.div`
  width: 100%;
  padding: 0 ${({theme:e})=>4*e.gridUnit}px
    ${({theme:e})=>3*e.gridUnit}px;
  background-color: ${({theme:e})=>e.colors.grayscale.light5};
`,X=s.iK.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  > *:first-child {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`,P=U.get("alertsreports.header.icon"),W=(0,v.ZP)((function({addDangerToast:e,isReportEnabled:t=!1,user:a,addSuccessToast:r}){const i=t?(0,o.t)("report"):(0,o.t)("alert"),s=t?(0,o.t)("reports"):(0,o.t)("alerts"),d=t?"Reports":"Alerts",v=(0,l.useMemo)((()=>[{id:"type",operator:g.p.Equals,value:t?"Report":"Alert"}]),[t]),{state:{loading:w,resourceCount:k,resourceCollection:S,bulkSelectEnabled:T,lastFetched:A},hasPerm:U,fetchData:W,setResourceCollection:Y,refreshData:q,toggleBulkSelect:G}=(0,L.Yi)("report",(0,o.t)("reports"),e,!0,void 0,v),{updateResource:O}=(0,L.LE)("report",(0,o.t)("reports"),e),[V,j]=(0,l.useState)(!1),[F,J]=(0,l.useState)(null),[Q,ee]=(0,l.useState)(null);function te(e){J(e),j(!0)}const ae=U("can_write"),le=U("can_write"),ne=U("can_write");(0,l.useEffect)((()=>{T&&le&&G()}),[t]);const re=[{id:"name",desc:!0}],oe=(0,l.useCallback)(((e,t)=>{if(null!=e&&e.id){const a=e.id,l=[...S];Y(l.map((a=>(null==a?void 0:a.id)===e.id?{...a,active:t}:a))),O(a,{active:t},!1,!1).then().catch((()=>Y(l)))}}),[S,Y,O]),ie=(0,l.useMemo)((()=>[{Cell:({row:{original:{last_state:e}}})=>(0,$.tZ)(y.Z,{state:e,isReportEnabled:t}),accessor:"last_state",size:"xs",disableSortBy:!0},{Cell:({row:{original:{last_eval_dttm:e}}})=>e?u().utc(e).local().format(f.v2):"",accessor:"last_eval_dttm",Header:(0,o.t)("Last run"),size:"lg"},{accessor:"name",Header:(0,o.t)("Name"),size:"xl"},{Header:(0,o.t)("Schedule"),accessor:"crontab_humanized",size:"xl",Cell:({row:{original:{crontab_humanized:e="",timezone:t}}})=>(0,$.tZ)(m.u,{title:`${e} (${t})`,placement:"topLeft",children:(0,$.tZ)("span",{children:`${e} (${t})`})})},{Cell:({row:{original:{recipients:e}}})=>e.map((e=>(0,$.tZ)(x,{type:e.type},e.id))),accessor:"recipients",Header:(0,o.t)("Notification method"),disableSortBy:!0,size:"xl"},{Cell:({row:{original:{owners:e=[]}}})=>(0,$.tZ)(h.Z,{users:e}),Header:(0,o.t)("Owners"),id:"owners",disableSortBy:!0,size:"xl"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,$.tZ)(N.w,{date:e,user:t}),Header:(0,o.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl"},{Cell:({row:{original:e}})=>{const t=e.owners.map((e=>e.id)).includes(a.userId)||(0,D.i5)(a);return(0,$.tZ)(Z.r,{disabled:!t,checked:e.active,onClick:t=>oe(e,t),size:"small"})},Header:(0,o.t)("Active"),accessor:"active",id:"active",size:"xl"},{Cell:({row:{original:e}})=>{const t=(0,n.k6)(),l=e.owners.map((e=>e.id)).includes(a.userId)||(0,D.i5)(a),r=[ae?{label:"execution-log-action",tooltip:(0,o.t)("Execution log"),placement:"bottom",icon:"Note",onClick:()=>t.push(`/${e.type.toLowerCase()}/${e.id}/log`)}:null,ae?{label:l?"edit-action":"preview-action",tooltip:l?(0,o.t)("Edit"):(0,o.t)("View"),placement:"bottom",icon:l?"Edit":"Binoculars",onClick:()=>te(e)}:null,l&&le?{label:"delete-action",tooltip:(0,o.t)("Delete"),placement:"bottom",icon:"Trash",onClick:()=>ee(e)}:null].filter((e=>null!==e));return(0,$.tZ)(p.Z,{actions:r})},Header:(0,o.t)("Actions"),id:"actions",hidden:!ae&&!le,disableSortBy:!0,size:"xl"},{accessor:R.J.ChangedBy,hidden:!0}]),[le,ae,t,oe]),se=[];ne&&se.push({name:(0,$.BX)($.HY,{children:[(0,$.tZ)("i",{className:"fa fa-plus"})," ",i]}),buttonStyle:"primary",onClick:()=>{te(null)}}),le&&se.push({name:(0,o.t)("Bulk select"),onClick:G,buttonStyle:"secondary"});const ce={title:(0,o.t)("No %s yet",s),image:"filter-results.svg",buttonAction:()=>te(null),buttonText:ne?(0,$.BX)($.HY,{children:[(0,$.tZ)("i",{className:"fa fa-plus"})," ",i," "]}):null},de=(0,l.useMemo)((()=>[{Header:(0,o.t)("Name"),key:"search",id:"name",input:"search",operator:g.p.Contains},{Header:(0,o.t)("Owner"),key:"owner",id:"owners",input:"select",operator:g.p.RelationManyMany,unfilteredLabel:(0,o.t)("All"),fetchSelects:(0,z.tm)("report","owners",(0,z.v$)((e=>(0,o.t)("An error occurred while fetching owners values: %s",e))),a),paginate:!0},{Header:(0,o.t)("Status"),key:"status",id:"last_state",input:"select",operator:g.p.Equals,unfilteredLabel:"Any",selects:[{label:K[C.Z9.Success],value:C.Z9.Success},{label:K[C.Z9.Working],value:C.Z9.Working},{label:K[C.Z9.Error],value:C.Z9.Error},{label:K[C.Z9.Noop],value:C.Z9.Noop},{label:K[C.Z9.Grace],value:C.Z9.Grace}]},{Header:(0,o.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:g.p.RelationOneMany,unfilteredLabel:(0,o.t)("All"),fetchSelects:(0,z.tm)("report","changed_by",(0,z.v$)((e=>(0,o.t)("An error occurred while fetching dataset datasource values: %s",e))),a),paginate:!0}]),[]),ue=P?(0,$.BX)(X,{children:[(0,$.tZ)("div",{children:(0,o.t)("Alerts & reports")}),(0,$.tZ)(P,{})]}):(0,o.t)("Alerts & reports");return(0,$.BX)($.HY,{children:[(0,$.tZ)(b.Z,{activeChild:d,name:ue,tabs:[{name:"Alerts",label:(0,o.t)("Alerts"),url:"/alert/list/",usesRouter:!0},{name:"Reports",label:(0,o.t)("Reports"),url:"/report/list/",usesRouter:!0}],buttons:se,children:(0,$.tZ)(I,{children:(0,$.tZ)(H,{updatedAt:A,update:()=>q()})})}),(0,$.tZ)(B.ZP,{alert:F,addDangerToast:e,layer:F,onHide:()=>{j(!1),J(null),q()},show:V,isReport:t},(null==F?void 0:F.id)||`${(new Date).getTime()}`),Q&&(0,$.tZ)(_.Z,{description:(0,o.t)("This action will permanently delete %s.",Q.name),onConfirm:()=>{Q&&(({id:t,name:a})=>{c.Z.delete({endpoint:`/api/v1/report/${t}`}).then((()=>{q(),ee(null),r((0,o.t)("Deleted: %s",a))}),(0,z.v$)((t=>e((0,o.t)("There was an issue deleting %s: %s",a,t)))))})(Q)},onHide:()=>ee(null),open:!0,title:(0,o.t)("Delete %s?",i)}),(0,$.tZ)(E.Z,{title:(0,o.t)("Please confirm"),description:(0,o.t)("Are you sure you want to delete the selected %s?",s),onConfirm:async t=>{try{const{message:e}=await M(t.map((({id:e})=>e)));q(),r(e)}catch(t){(0,z.v$)((t=>e((0,o.t)("There was an issue deleting the selected %s: %s",s,t))))(t)}},children:t=>{const a=le?[{key:"delete",name:(0,o.t)("Delete"),onSelect:t,type:"danger"}]:[];return(0,$.tZ)(g.Z,{className:"alerts-list-view",columns:ie,count:k,data:S,emptyState:ce,fetchData:W,filters:de,initialSort:re,loading:w,bulkActions:a,bulkSelectEnabled:T,disableBulkSelect:G,refreshData:q,addDangerToast:e,addSuccessToast:r,pageSize:25})}})]})}))},83379:(e,t,a)=>{function l(e){return e?`${e.first_name} ${e.last_name}`:""}a.d(t,{Z:()=>l})}}]);
//# sourceMappingURL=3c867ff67a75911cfe0e.chunk.js.map